<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>{{ producto.nombre }}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
{% extends 'layout.html' %}
{% block content %}
<h2>{{ producto.nombre }}</h2>
<p><b>Categoría:</b> {{ producto.categoria.nombre }}</p>
<p><b>Precio:</b> ${{ producto.precio }}</p>
<p><b>Estado:</b> {{ producto.estado }}</p>
<p><b>Descripción:</b> {{ producto.descripcion }}</p>
<p><b>Publicado:</b> {{ producto.fecha_publicacion }}</p>

<h3>Imágenes</h3>
<div class="imagenes">
  {% for img in imagenes %}
    <img src="{{ url_for('static', filename='uploads/' ~ img.archivo) }}" alt="Imagen de producto" width="120">
  {% else %}
    <p>No hay imágenes.</p>
  {% endfor %}
</div>
{% if session.get('user_id') == producto.usuario_id %}
<form method="post" enctype="multipart/form-data">
  <input type="file" name="imagen" accept="image/*">
  <button type="submit">Subir imagen</button>
</form>
{% endif %}

<h3>Reseñas</h3>
<ul>
  {% for r in resenas %}
    <li><b>{{ r.usuario_id }}</b> ({{ r.fecha }}): {{ r.texto }}</li>
  {% else %}
    <li>No hay reseñas.</li>
  {% endfor %}
</ul>
{% if session.get('user_id') %}
<form method="post">
  <input type="text" name="resena" placeholder="Escribe una reseña">
  <button type="submit">Agregar reseña</button>
</form>
{% endif %}

<h3>Comentarios</h3>
<ul>
  {% for c in comentarios %}
    <li><b>{{ c.usuario_id }}</b> ({{ c.fecha }}): {{ c.texto }}</li>
  {% else %}
    <li>No hay comentarios.</li>
  {% endfor %}
</ul>
{% if session.get('user_id') %}
<form method="post">
  <input type="text" name="comentario" placeholder="Escribe un comentario">
  <button type="submit">Agregar comentario</button>
</form>
{% endif %}

<h3>Ofertas</h3>
<ul>
  {% for o in ofertas %}
    <li><b>{{ o.usuario_id }}</b> ({{ o.fecha }}): ${{ o.monto }}</li>
  {% else %}
    <li>No hay ofertas.</li>
  {% endfor %}
</ul>
{% if session.get('user_id') %}
<form method="post">
  <input type="number" name="oferta" step="0.01" placeholder="Tu oferta">
  <button type="submit">Enviar oferta</button>
</form>
{% endif %}

<h3>Pagos</h3>
<ul>
  {% for p in pagos %}
    <li><b>{{ p.usuario_id }}</b> ({{ p.fecha }}): ${{ p.monto }} [{{ p.estado }}]</li>
  {% else %}
    <li>No hay pagos.</li>
  {% endfor %}
</ul>
{% if session.get('user_id') %}
<form method="post">
  <input type="number" name="pago" step="0.01" placeholder="Monto a pagar">
  <button type="submit">Pagar</button>
</form>
{% endif %}
{% endblock %}
</body>
</html>
